# 🔎 Vulnerability Assessment with Wazuh

## 📌 Overview
Vulnerability assessment is a critical component of cybersecurity, helping to identify **outdated software, security misconfigurations, and known CVEs (Common Vulnerabilities and Exposures)**. **Wazuh SIEM** includes a built-in **Vulnerability Detector** that scans installed software and maps it against **MITRE CVE databases**.

✅ **Key Features:**
- Detects outdated packages and security weaknesses.
- Periodic scans for new vulnerabilities.
- Generates **risk-based alerts** with CVSS scores.
- Helps prioritize security patches and mitigations.

---

## 1️⃣ Enabling Wazuh Vulnerability Detector
### **🔹 Step 1: Configure Wazuh to Scan for Vulnerabilities**
1. Open Wazuh’s configuration file:
   ```bash
   sudo nano /var/ossec/etc/ossec.conf
   ```
2. Add the following configuration under `<wodle name="vulnerability-detector">`:
   ```xml
   <wodle name="vulnerability-detector">
     <enabled>yes</enabled>
     <provider>
       <name>canonical</name>
       <enabled>yes</enabled>
     </provider>
   </wodle>
   ```
3. Save the file and restart Wazuh:
   ```bash
   sudo systemctl restart wazuh-manager
   ```

---

## 2️⃣ Running Automated Vulnerability Scans
### **🔹 Step 1: Start a Manual Scan**
1. Run the following command to initiate a **vulnerability scan**:
   ```bash
   sudo /var/ossec/bin/wazuh-analysisd -f
   ```
2. Monitor the logs for detected vulnerabilities:
   ```bash
   tail -f /var/ossec/logs/alerts/alerts.json | jq '.'
   ```

### **🔹 Step 2: View Detected Vulnerabilities in Wazuh**
1. Open the **Wazuh Dashboard** (`https://<SIEM-IP>:5601`).
2. Navigate to **Security Events > Vulnerability Detection**.
3. Review the reported CVEs along with their severity levels.

---

## 3️⃣ Analyzing & Mitigating Vulnerabilities
### **🔹 Step 1: Identify High-Risk Vulnerabilities**
Each detected vulnerability includes:
- **CVE ID** (e.g., `CVE-2024-12345`)
- **Severity Score (CVSS v3.1)**
- **Affected Software Version**
- **Recommended Patch or Workaround**

Example alert from Wazuh logs:
```json
{
  "rule": {
    "id": "100010",
    "description": "High-risk vulnerability detected: CVE-2024-12345"
  },
  "vulnerability": {
    "package": "openssl",
    "version": "1.1.1g",
    "cvss_score": "9.8"
  },
  "alert_level": 9
}
```

### **🔹 Step 2: Apply Security Patches**
1. Update the affected package:
   ```bash
   sudo apt update && sudo apt upgrade openssl -y
   ```
2. Restart the system if required:
   ```bash
   sudo reboot
   ```

---

## 4️⃣ Automating Vulnerability Reports
To generate periodic vulnerability assessment reports:
1. Schedule automatic scans using cron:
   ```bash
   sudo crontab -e
   ```
   Add the following entry to run daily at midnight:
   ```bash
   0 0 * * * /var/ossec/bin/wazuh-analysisd -f
   ```

2. Export vulnerability reports:
   ```bash
   sudo cat /var/ossec/logs/alerts/alerts.json | jq '.vulnerability' > vulnerability_report.json
   ```

---

## 🎯 Summary
🚀 **Your Vulnerability Assessment module is now active!**
- **Identify security weaknesses** with automated scans.
- **View CVE reports** in Wazuh and prioritize patches.
- **Automate security updates** to strengthen your system.

🔹 **Next Steps:** Explore **[Malicious Command Execution Detection](Malicious_Command_Detection.md)** to prevent privilege escalation attacks!